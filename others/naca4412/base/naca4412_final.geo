// Length computational domain 
L_xd = 45;
L_y  = 20;

// NACA 4412 airfoil coordinates
// Trailing edge evaluation
X_te = 1;
Y_te = 0;
Point(1)   = {1,0,0,1.0};
Point(2)   = {0.999753,7e-05,0,1.0};
Point(3)   = {0.999013,0.000279,0,1.0};
Point(4)   = {0.997779,0.000627,0,1.0};
Point(5)   = {0.996054,0.001113,0,1.0};
Point(6)   = {0.993838,0.001734,0,1.0};
Point(7)   = {0.991134,0.00249,0,1.0};
Point(8)   = {0.987944,0.003378,0,1.0};
Point(9)   = {0.984271,0.004394,0,1.0};
Point(10)  = {0.980118,0.005537,0,1.0};
Point(11)  = {0.975488,0.006801,0,1.0};
Point(12)  = {0.970386,0.008184,0,1.0};
Point(13)  = {0.964817,0.009681,0,1.0};
Point(14)  = {0.958785,0.011288,0,1.0};
Point(15)  = {0.952295,0.012999,0,1.0};
Point(16)  = {0.945354,0.014809,0,1.0};
Point(17)  = {0.937968,0.016714,0,1.0};
Point(18)  = {0.930144,0.018707,0,1.0};
Point(19)  = {0.921888,0.020783,0,1.0};
Point(20)  = {0.913208,0.022935,0,1.0};
Point(21)  = {0.904113,0.025159,0,1.0};
Point(22)  = {0.89461,0.027446,0,1.0};
Point(23)  = {0.884709,0.029791,0,1.0};
Point(24)  = {0.874418,0.032187,0,1.0};
Point(25)  = {0.863748,0.034628,0,1.0};
Point(26)  = {0.852709,0.037107,0,1.0};
Point(27)  = {0.84131,0.039617,0,1.0};
Point(28)  = {0.829563,0.042151,0,1.0};
Point(29)  = {0.817479,0.044704,0,1.0};
Point(30)  = {0.805069,0.047268,0,1.0};
Point(31)  = {0.792346,0.049835,0,1.0};
Point(32)  = {0.779321,0.052401,0,1.0};
Point(33)  = {0.766008,0.054958,0,1.0};
Point(34)  = {0.75242,0.057499,0,1.0};
Point(35)  = {0.738569,0.060019,0,1.0};
Point(36)  = {0.724469,0.06251,0,1.0};
Point(37)  = {0.710134,0.064966,0,1.0};
Point(38)  = {0.695579,0.067381,0,1.0};
Point(39)  = {0.680817,0.069749,0,1.0};
Point(40)  = {0.665864,0.072063,0,1.0};
Point(41)  = {0.650734,0.074319,0,1.0};
Point(42)  = {0.635442,0.076509,0,1.0};
Point(43)  = {0.620005,0.078629,0,1.0};
Point(44)  = {0.604437,0.080672,0,1.0};
Point(45)  = {0.588755,0.082634,0,1.0};
Point(46)  = {0.572974,0.084509,0,1.0};
Point(47)  = {0.557111,0.086291,0,1.0};
Point(48)  = {0.541181,0.087977,0,1.0};
Point(49)  = {0.525201,0.089561,0,1.0};
Point(50)  = {0.509188,0.091039,0,1.0};
Point(51)  = {0.493159,0.092407,0,1.0};
Point(52)  = {0.477129,0.09366,0,1.0};
Point(53)  = {0.461116,0.094795,0,1.0};
Point(54)  = {0.445136,0.095809,0,1.0};
Point(55)  = {0.429207,0.096697,0,1.0};
Point(56)  = {0.413344,0.097457,0,1.0};
Point(57)  = {0.397527,0.098086,0,1.0};
Point(58)  = {0.381597,0.098537,0,1.0};
Point(59)  = {0.365782,0.098785,0,1.0};
Point(60)  = {0.3501,0.09883,0,1.0};
Point(61)  = {0.33457,0.098674,0,1.0};
Point(62)  = {0.319209,0.098316,0,1.0};
Point(63)  = {0.304036,0.09776,0,1.0};
Point(64)  = {0.289066,0.097008,0,1.0};
Point(65)  = {0.274319,0.096064,0,1.0};
Point(66)  = {0.25981,0.094932,0,1.0};
Point(67)  = {0.245557,0.093616,0,1.0};
Point(68)  = {0.231576,0.092122,0,1.0};
Point(69)  = {0.217883,0.090456,0,1.0};
Point(70)  = {0.204494,0.088625,0,1.0};
Point(71)  = {0.191424,0.086634,0,1.0};
Point(72)  = {0.178687,0.084493,0,1.0};
Point(73)  = {0.166299,0.082208,0,1.0};
Point(74)  = {0.154273,0.079789,0,1.0};
Point(75)  = {0.142623,0.077244,0,1.0};
Point(76)  = {0.13136,0.074582,0,1.0};
Point(77)  = {0.120498,0.071812,0,1.0};
Point(78)  = {0.110048,0.068945,0,1.0};
Point(79)  = {0.10002,0.06599,0,1.0};
Point(80)  = {0.090426,0.062958,0,1.0};
Point(81)  = {0.081275,0.059857,0,1.0};
Point(82)  = {0.072576,0.056699,0,1.0};
Point(83)  = {0.064338,0.053493,0,1.0};
Point(84)  = {0.056568,0.05025,0,1.0};
Point(85)  = {0.049274,0.046978,0,1.0};
Point(86)  = {0.042462,0.043688,0,1.0};
Point(87)  = {0.036138,0.040388,0,1.0};
Point(88)  = {0.030309,0.037088,0,1.0};
Point(89)  = {0.024977,0.033796,0,1.0};
Point(90)  = {0.020149,0.03052,0,1.0};
Point(91)  = {0.015826,0.027267,0,1.0};
Point(92)  = {0.012012,0.024045,0,1.0};
Point(93)  = {0.00871,0.02086,0,1.0};
Point(94)  = {0.005921,0.017718,0,1.0};
Point(95)  = {0.003647,0.014624,0,1.0};
Point(96)  = {0.001888,0.011582,0,1.0};
Point(97)  = {0.000644,0.008596,0,1.0};
Point(98)  = {-8.4e-05,0.005669,0,1.0};
Point(99)  = {-0.000298,0.002803,0,1.0};
Point(100) = {0,0,0,1.0};
Point(101) = {0.000802,-0.002703,0,1.0};
Point(102) = {0.002097,-0.005267,0,1.0};
Point(103) = {0.003884,-0.007693,0,1.0};
Point(104) = {0.006157,-0.009981,0,1.0};
Point(105) = {0.008914,-0.012131,0,1.0};
Point(106) = {0.01215,-0.014145,0,1.0};
Point(107) = {0.01586,-0.016022,0,1.0};
Point(108) = {0.020039,-0.017763,0,1.0};
Point(109) = {0.024681,-0.019371,0,1.0};
Point(110) = {0.02978,-0.020845,0,1.0};
Point(111) = {0.03533,-0.022189,0,1.0};
Point(112) = {0.041323,-0.023403,0,1.0};
Point(113) = {0.047753,-0.024489,0,1.0};
Point(114) = {0.054612,-0.025451,0,1.0};
Point(115) = {0.061891,-0.02629,0,1.0};
Point(116) = {0.069583,-0.027009,0,1.0};
Point(117) = {0.077679,-0.027611,0,1.0};
Point(118) = {0.08617,-0.0281,0,1.0};
Point(119) = {0.095048,-0.028479,0,1.0};
Point(120) = {0.104304,-0.028752,0,1.0};
Point(121) = {0.113926,-0.028923,0,1.0};
Point(122) = {0.123908,-0.028996,0,1.0};
Point(123) = {0.134237,-0.028977,0,1.0};
Point(124) = {0.144906,-0.028869,0,1.0};
Point(125) = {0.155902,-0.028678,0,1.0};
Point(126) = {0.167217,-0.02841,0,1.0};
Point(127) = {0.17884,-0.028071,0,1.0};
Point(128) = {0.19076,-0.027665,0,1.0};
Point(129) = {0.202967,-0.027199,0,1.0};
Point(130) = {0.215449,-0.02668,0,1.0};
Point(131) = {0.228197,-0.026114,0,1.0};
Point(132) = {0.241199,-0.025507,0,1.0};
Point(133) = {0.254443,-0.024866,0,1.0};
Point(134) = {0.267919,-0.024198,0,1.0};
Point(135) = {0.281615,-0.02351,0,1.0};
Point(136) = {0.295519,-0.022809,0,1.0};
Point(137) = {0.309619,-0.0221,0,1.0};
Point(138) = {0.323904,-0.021393,0,1.0};
Point(139) = {0.338362,-0.020692,0,1.0};
Point(140) = {0.35298,-0.020005,0,1.0};
Point(141) = {0.367745,-0.019338,0,1.0};
Point(142) = {0.382645,-0.018697,0,1.0};
Point(143) = {0.397666,-0.018089,0,1.0};
Point(144) = {0.413008,-0.017496,0,1.0};
Point(145) = {0.428479,-0.016882,0,1.0};
Point(146) = {0.444026,-0.01625,0,1.0};
Point(147) = {0.459634,-0.015605,0,1.0};
Point(148) = {0.475289,-0.014951,0,1.0};
Point(149) = {0.490976,-0.014291,0,1.0};
Point(150) = {0.506678,-0.013628,0,1.0};
Point(151) = {0.522381,-0.012967,0,1.0};
Point(152) = {0.538069,-0.012309,0,1.0};
Point(153) = {0.553728,-0.011659,0,1.0};
Point(154) = {0.569341,-0.011019,0,1.0};
Point(155) = {0.584893,-0.01039,0,1.0};
Point(156) = {0.600369,-0.009776,0,1.0};
Point(157) = {0.615754,-0.009178,0,1.0};
Point(158) = {0.631031,-0.008598,0,1.0};
Point(159) = {0.646187,-0.008037,0,1.0};
Point(160) = {0.661204,-0.007497,0,1.0};
Point(161) = {0.676069,-0.006978,0,1.0};
Point(162) = {0.690767,-0.006481,0,1.0};
Point(163) = {0.705281,-0.006007,0,1.0};
Point(164) = {0.719598,-0.005555,0,1.0};
Point(165) = {0.733702,-0.005127,0,1.0};
Point(166) = {0.74758,-0.004722,0,1.0};
Point(167) = {0.761217,-0.004339,0,1.0};
Point(168) = {0.774599,-0.003979,0,1.0};
Point(169) = {0.787711,-0.00364,0,1.0};
Point(170) = {0.800541,-0.003323,0,1.0};
Point(171) = {0.813074,-0.003027,0,1.0};
Point(172) = {0.825298,-0.002751,0,1.0};
Point(173) = {0.837199,-0.002493,0,1.0};
Point(174) = {0.848766,-0.002254,0,1.0};
Point(175) = {0.859986,-0.002033,0,1.0};
Point(176) = {0.870846,-0.001827,0,1.0};
Point(177) = {0.881335,-0.001638,0,1.0};
Point(178) = {0.891443,-0.001462,0,1.0};
Point(179) = {0.901157,-0.001301,0,1.0};
Point(180) = {0.910468,-0.001153,0,1.0};
Point(181) = {0.919366,-0.001017,0,1.0};
Point(182) = {0.92784,-0.000892,0,1.0};
Point(183) = {0.935881,-0.000778,0,1.0};
Point(184) = {0.943481,-0.000674,0,1.0};
Point(185) = {0.950631,-0.000579,0,1.0};
Point(186) = {0.957324,-0.000493,0,1.0};
Point(187) = {0.963551,-0.000415,0,1.0};
Point(188) = {0.969306,-0.000345,0,1.0};
Point(189) = {0.974583,-0.000283,0,1.0};
Point(190) = {0.979375,-0.000227,0,1.0};
Point(191) = {0.983678,-0.000178,0,1.0};
Point(192) = {0.987485,-0.000135,0,1.0};
Point(193) = {0.990794,-9.9e-05,0,1.0};
Point(194) = {0.993601,-6.8e-05,0,1.0};
Point(195) = {0.995901,-4.4e-05,0,1.0};
Point(196) = {0.997693,-2.4e-05,0,1.0};
Point(197) = {0.998974,-1.1e-05,0,1.0};
Point(198) = {0.999743,-3e-06,0,1.0};

// External domain
Point(199) = {X_te, L_y+Y_te, 0, 1.0};
Point(200) = {X_te, -L_y+Y_te, 0, 1.0};
Point(201) = {L_xd,  L_y+Y_te, 0, 1.0};
Point(202) = {L_xd, -L_y+Y_te, 0, 1.0};

// Auxiliary points
Point(203) = {L_xd, Y_te, 0, 1.0};
Point(204) = {-L_y+X_te, Y_te, 0, 1.0};
Point(205) = {-1.5*X_te, Y_te, 0, 1.0};
Point(206) = {X_te, 2.5*X_te+Y_te, 0, 1.0};
Point(207) = {X_te, -2.5*X_te+Y_te, 0, 1.0};
Point(208) = {L_xd, 2.5*X_te+Y_te, 0, 1.0};
Point(209) = {L_xd, -2.5*X_te+Y_te, 0, 1.0};

// NACA 4412 airfoil lines
Line(1)    = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100};
Line(2)    = {100, 101, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 1};

// External domain lines
Line(3)    = {206, 199};
Line(4)    = {207, 200};
Line(5)    = {208, 201};
Line(6)    = {209, 202};
Line(7)    = {1, 203};
Line(8)    = {199, 201};
Line(9)    = {200, 202};
Circle(10) = {199, 1, 204};
Circle(11) = {204, 1, 200};
Line(12)   = {205, 100};
Circle(13) = {206, 1, 205};
Circle(14) = {205, 1, 207};
Line(15)   = {206, 1};
Line(16)   = {207, 1};
Line(17)   = {206, 208};
Line(18)   = {207, 209};
Line(19)   = {208, 203};
Line(20)   = {209, 203};
Line(21)   = {204, 205};

Ny = 34; // 60
Nx = 28; // 60
Transfinite Line {3, 5} = Ny/2 Using Progression 1.15;
Transfinite Line {4, 6} = Ny/2 Using Progression 1.15;
Transfinite Line {15, 19} = Ny Using Progression 0.875;
Transfinite Line {16, 20} = Ny Using Progression 0.875;
Transfinite Line {7, 8, 9, 17, 18} = 2*Nx Using Progression 1.1275;
Transfinite Line {12}      = Ny Using Progression 0.875;
Transfinite Line {21}      = Ny/2 Using Progression 0.875;
Transfinite Line {10, 13}   = 2*Nx;
Transfinite Line {11, 14}   = 2*Nx;
Transfinite Line {1}   = 2*Nx Using Bump 0.15;
Transfinite Line {2}   = 2*Nx Using Bump 0.15;

// Surfaces
Line Loop(1) = {3, 8, -5, -17};
Plane Surface(1) = {1};
Line Loop(2) = {9, -6, -18, 4};
Plane Surface(2) = {2};
Line Loop(3) = {7, -20, -18, 16};
Plane Surface(3) = {3};
Line Loop(4) = {17, 19, -7, -15};
Plane Surface(4) = {4};
Line Loop(5) = {3, 10, 21, -13};
Plane Surface(5) = {5};
Line Loop(6) = {21, 14, 4, -11};
Plane Surface(6) = {6};
Line Loop(7) = {14, 16, -2, -12};
Plane Surface(7) = {7};
Line Loop(8) = {12, -1, -15, 13};
Plane Surface(8) = {8};

Physical Line("wall")    = {1, 2};
Physical Line("inlet")   = {10, 11};
Physical Line("outlet")  = {5, 19, 20, 6};
Physical Line("bottom")  = {9};
Physical Line("top")     = {8};
Physical Surface("flow") = {1:8};


// Recombine & transfinite
Recombine Surface "*";
Transfinite Surface "*";

Coherence;